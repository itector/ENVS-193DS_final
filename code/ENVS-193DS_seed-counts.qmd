---
title: "ENVS-193DS_seed-counts"
format: 
  html:
    toc: true
    toc-location: left
    code-fold: true
    theme: yeti
editor: visual
execute: 
  message: false
  warning: false
editor: visual
editor: visual
---

## Seed Counts

# Introduction

testing

# Methods

```{r}
# should haves
library(tidyverse)
library(here)
library(janitor)
library(ggeffects)
library(performance)
library(naniar)
library(skimr)
library(flextable)
library(car)
library(broom)
library(corrplot)
library(AICcmodavg)
library(GGally)
# would be nice to have
library(MuMIn)
#library(equatiomatic)
library(corrplot)
```

```{r}
seed_count <- read_csv(here("data", "shrubstudy_seed_ctwt.ms.data.csv")) %>% 
  # make the column names cleaner
  clean_names()
```

```{r}
ggplot(seed_count, aes(x = nr_seeds)) +
  geom_histogram(bins = 17)
```

```{r}
seed_count %>% 
  select(!treatment) %>% 
  ggpairs()
```

```{r}
skim(seed_count)
```

```{r}
seed_count_subset <- drop_na(seed_count) # %>% 
  #drop_na(dist_fr_shr, wt_seeds_mg, nr_seeds, nr_infl_coll)
```

```{r}
# calculate pearson's r for numerical values only
seed_count_cor <- seed_count_subset %>% 
  select(shrub_num,plant_nr,dist_fr_shr,total_nr_infl,nr_infl_coll,nr_seeds,wt_seeds_mg) %>% 
  cor(method = "pearson")

# creating a correlation plot
corrplot(seed_count_cor,
         # change the shape of what's in the cells
         method = "ellipse",
         addCoef.col = "black"
         )
```

```{r}
# create a pairs plot (not correlation) for all of the variables
seed_count_subset %>% 
  select(shrub_num,plant_nr,dist_fr_shr,total_nr_infl,nr_infl_coll,nr_seeds,wt_seeds_mg) %>% 
  ggpairs()
```

```{r}
# make a new data set with relevant variables
seed_count_rel <- seed_count %>% 
  select(nr_seeds, treatment, species, total_nr_infl) %>% 
  drop_na(nr_seeds, treatment, species, total_nr_infl)
```

```{r}
# making a null model, which is represented by a one and we only want it from the plant_subset dataset
null <- lm(nr_seeds ~ 1, data = seed_count_rel)
# now we include all of the variables
full <- lm(nr_seeds ~ treatment + species + total_nr_infl, data = seed_count_rel)
```

```{r}
# create a diagnostic plot for full model
par(mfrow = c(2,2))
plot(full)

```

```{r}
check_normality(full)
check_heteroscedasticity(full)
```

```{r}
# transform data by taking the log of it
full_log <- lm(log(nr_seeds) ~ species + treatment + total_nr_infl, data = seed_count_rel)

null_log <- lm(log(nr_seeds) ~ 1, data = seed_count_rel)

# check transformed data for normality and const variance
par(mfrow = c(2,2))
plot(full_log)
check_normality(full_log)
check_heteroscedasticity(full_log)
```

# Results

# Works Cited
